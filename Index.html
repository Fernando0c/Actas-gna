<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css"> @import url(https://themes.googleusercontent.com/fonts/css?kit=kbffV7V9BIH3Ot2AQ2LQRA);</style></head><body class="doc-content" style="background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt"><p style="padding:0;margin:0;color:#000000;font-size:11pt;font-family:&quot;Arial&quot;;line-height:1.0;text-align:left"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:&quot;Courier&quot;;font-style:normal">&lt;!DOCTYPE html&gt;<br>&lt;html lang=&quot;es&quot;&gt;<br>&lt;head&gt;<br> &nbsp; &nbsp;&lt;meta charset=&quot;UTF-8&quot;&gt;<br> &nbsp; &nbsp;&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;<br> &nbsp; &nbsp;&lt;title&gt;Sistema de Partes de Infracci&oacute;n - Gendarmer&iacute;a Nacional&lt;/title&gt;<br> &nbsp; &nbsp;<br> &nbsp; &nbsp;&lt;!-- Tailwind CSS --&gt;<br> &nbsp; &nbsp;&lt;script src=&quot;https://cdn.tailwindcss.com&quot;&gt;&lt;/script&gt;<br> &nbsp; &nbsp;<br> &nbsp; &nbsp;&lt;!-- Google Fonts: Inter --&gt;<br> &nbsp; &nbsp;&lt;link rel=&quot;preconnect&quot; href=&quot;https://fonts.googleapis.com&quot;&gt;<br> &nbsp; &nbsp;&lt;link rel=&quot;preconnect&quot; href=&quot;https://fonts.gstatic.com&quot; crossorigin&gt;<br> &nbsp; &nbsp;&lt;link href=&quot;https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap&quot; rel=&quot;stylesheet&quot;&gt;<br> &nbsp; &nbsp;<br> &nbsp; &nbsp;&lt;!-- Font Awesome --&gt;<br> &nbsp; &nbsp;&lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css&quot;&gt;<br> &nbsp; &nbsp;<br> &nbsp; &nbsp;&lt;!-- Leaflet (para mapas) --&gt;<br> &nbsp; &nbsp;&lt;link rel=&quot;stylesheet&quot; href=&quot;https://unpkg.com/leaflet@1.9.4/dist/leaflet.css&quot; integrity=&quot;sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=&quot; crossorigin=&quot;&quot;/&gt;<br> &nbsp; &nbsp;&lt;script src=&quot;https://unpkg.com/leaflet@1.9.4/dist/leaflet.js&quot; integrity=&quot;sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=&quot; crossorigin=&quot;&quot;&gt;&lt;/script&gt;<br><br> &nbsp; &nbsp;&lt;style&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;body { font-family: &#39;Inter&#39;, sans-serif; background-color: #f0f2f0; }<br> &nbsp; &nbsp; &nbsp; &nbsp;.dark body { background-color: #1a202c; }<br> &nbsp; &nbsp; &nbsp; &nbsp;.hidden { display: none; }<br> &nbsp; &nbsp; &nbsp; &nbsp;#map { height: 250px; border-radius: 0.5rem; border: 1px solid #ccc; z-index: 1; }<br> &nbsp; &nbsp; &nbsp; &nbsp;@media print {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;body * { visibility: hidden; }<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#printable-area, #printable-area * { visibility: visible; }<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#printable-area { position: absolute; left: 0; top: 0; width: 100%; }<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.no-print { display: none; }<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp;&lt;/style&gt;<br>&lt;/head&gt;<br>&lt;body class=&quot;dark:bg-gray-900 text-gray-800 dark:text-gray-200&quot;&gt;<br><br> &nbsp; &nbsp;&lt;div id=&quot;app-container&quot; class=&quot;container mx-auto p-4 max-w-4xl&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;header class=&quot;text-center mb-6&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;img src=&quot;https://upload.wikimedia.org/wikipedia/commons/2/22/Escudo_de_la_Gendarmer%C3%ADa_Nacional_Argentina.png&quot; alt=&quot;Escudo de Gendarmer&iacute;a Nacional Argentina&quot; class=&quot;h-24 mx-auto mb-4&quot; onerror=&quot;this.style.display=&#39;none&#39;&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;h1 class=&quot;text-3xl font-bold text-green-800 dark:text-green-400&quot;&gt;Sistema de Actas de Procedimiento&lt;/h1&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;p class=&quot;text-md text-gray-600 dark:text-gray-400&quot;&gt;Gendarmer&iacute;a Nacional Argentina&lt;/p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/header&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=&quot;login-view&quot; class=&quot;bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg max-w-sm mx-auto mb-8&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;h2 class=&quot;text-2xl font-bold mb-4 text-center text-green-800 dark:text-green-400&quot;&gt;Acceso de Personal&lt;/h2&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;div class=&quot;bg-green-100 dark:bg-green-900 border-l-4 border-green-600 text-green-800 dark:text-green-300 p-4 rounded-md&quot; role=&quot;alert&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;p class=&quot;font-bold&quot;&gt;ID de Sesi&oacute;n (Cargador):&lt;/p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;p id=&quot;user-id-display&quot; class=&quot;text-xs break-all&quot;&gt;Cargando...&lt;/p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br><br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;main id=&quot;app-view&quot; class=&quot;hidden&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg mb-8&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;h2 class=&quot;text-2xl font-semibold mb-4 border-b border-gray-300 dark:border-gray-600 pb-2&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;i class=&quot;fas fa-plus-circle mr-2 text-green-700&quot;&gt;&lt;/i&gt;Cargar Nuevo Procedimiento<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/h2&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;form id=&quot;infraccion-form&quot; class=&quot;space-y-6&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;!-- Secci&oacute;n 1: Datos del Personal --&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;fieldset class=&quot;border border-gray-300 dark:border-gray-600 p-4 rounded-lg&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;legend class=&quot;px-2 font-semibold text-lg text-green-700 dark:text-green-500&quot;&gt;1. Datos del Personal&lt;/legend&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;div class=&quot;grid md:grid-cols-2 gap-6 mt-2&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div&gt;&lt;label for=&quot;agente-dni&quot; class=&quot;block mb-2 text-sm font-medium&quot;&gt;DNI del Personal a Cargo&lt;/label&gt;&lt;input type=&quot;text&quot; id=&quot;agente-dni&quot; class=&quot;bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-sm rounded-lg block w-full p-2.5&quot; required&gt;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div&gt;&lt;label for=&quot;agente-codigo&quot; class=&quot;block mb-2 text-sm font-medium&quot;&gt;C&oacute;digo Estad&iacute;stico&lt;/label&gt;&lt;input type=&quot;text&quot; id=&quot;agente-codigo&quot; class=&quot;bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-sm rounded-lg block w-full p-2.5&quot;&gt;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;md:col-span-2&quot;&gt;&lt;label for=&quot;patrulla&quot; class=&quot;block mb-2 text-sm font-medium&quot;&gt;Integrantes de la Patrulla&lt;/label&gt;&lt;textarea id=&quot;patrulla&quot; rows=&quot;3&quot; class=&quot;block p-2.5 w-full text-sm bg-gray-50 dark:bg-gray-700 rounded-lg border border-gray-300 dark:border-gray-600&quot; placeholder=&quot;Listar DNI y Nombre de cada integrante, uno por l&iacute;nea.&quot;&gt;&lt;/textarea&gt;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/fieldset&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;!-- Secci&oacute;n 2: Datos del Procedimiento --&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;fieldset class=&quot;border border-gray-300 dark:border-gray-600 p-4 rounded-lg&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;legend class=&quot;px-2 font-semibold text-lg text-green-700 dark:text-green-500&quot;&gt;2. Datos del Procedimiento&lt;/legend&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;grid md:grid-cols-2 gap-6 mt-2&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;div class=&quot;md:col-span-2&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;label for=&quot;caratula&quot; class=&quot;block mb-2 text-sm font-medium&quot;&gt;Car&aacute;tula&lt;/label&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;input type=&quot;text&quot; id=&quot;caratula&quot; class=&quot;bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-sm rounded-lg block w-full p-2.5&quot; placeholder=&quot;Ej: INFRACCI&Oacute;N LEY 23.737&quot; required&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;div&gt;&lt;label for=&quot;fecha-hora&quot; class=&quot;block mb-2 text-sm font-medium&quot;&gt;Fecha y Hora&lt;/label&gt;&lt;input type=&quot;datetime-local&quot; id=&quot;fecha-hora&quot; class=&quot;bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-sm rounded-lg block w-full p-2.5&quot; required&gt;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;div&gt;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;div class=&quot;md:col-span-2&quot;&gt;&lt;label for=&quot;lugar&quot; class=&quot;block mb-2 text-sm font-medium&quot;&gt;Lugar del Hecho&lt;/label&gt;&lt;div class=&quot;flex items-center space-x-2&quot;&gt;&lt;input type=&quot;text&quot; id=&quot;lugar&quot; class=&quot;bg-gray-50 dark:bg-gray-700 border text-sm rounded-lg block w-full p-2.5&quot; required&gt;&lt;button type=&quot;button&quot; id=&quot;get-location-btn&quot; class=&quot;p-2.5 bg-green-600 text-white rounded-lg hover:bg-green-700 flex-shrink-0&quot;&gt;&lt;i class=&quot;fas fa-map-marker-alt&quot;&gt;&lt;/i&gt;&lt;/button&gt;&lt;/div&gt;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;div class=&quot;md:col-span-2 grid grid-cols-2 gap-4&quot;&gt;&lt;div&gt;&lt;label for=&quot;latitud&quot; class=&quot;block mb-2 text-sm font-medium&quot;&gt;Latitud&lt;/label&gt;&lt;input type=&quot;text&quot; id=&quot;latitud&quot; class=&quot;bg-gray-200 dark:bg-gray-800 border text-sm rounded-lg block w-full p-2.5&quot; readonly&gt;&lt;/div&gt;&lt;div&gt;&lt;label for=&quot;longitud&quot; class=&quot;block mb-2 text-sm font-medium&quot;&gt;Longitud&lt;/label&gt;&lt;input type=&quot;text&quot; id=&quot;longitud&quot; class=&quot;bg-gray-200 dark:bg-gray-800 border text-sm rounded-lg block w-full p-2.5&quot; readonly&gt;&lt;/div&gt;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;div id=&quot;map-container&quot; class=&quot;md:col-span-2 hidden mt-2&quot;&gt;&lt;div id=&quot;map&quot;&gt;&lt;/div&gt;&lt;p id=&quot;location-status&quot; class=&quot;text-xs text-center mt-1 text-gray-500&quot;&gt;&lt;/p&gt;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;div&gt;&lt;label for=&quot;dni&quot; class=&quot;block mb-2 text-sm font-medium&quot;&gt;DNI del Imputado / Infractor&lt;/label&gt;&lt;input type=&quot;text&quot; id=&quot;dni&quot; class=&quot;bg-gray-50 dark:bg-gray-700 border text-sm rounded-lg block w-full p-2.5&quot; required&gt;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;div&gt;&lt;label for=&quot;dominio&quot; class=&quot;block mb-2 text-sm font-medium&quot;&gt;Dominio del Veh&iacute;culo&lt;/label&gt;&lt;input type=&quot;text&quot; id=&quot;dominio&quot; class=&quot;bg-gray-50 dark:bg-gray-700 border text-sm rounded-lg block w-full p-2.5&quot; required&gt;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;div class=&quot;md:col-span-2&quot;&gt;&lt;label class=&quot;block mb-2 text-sm font-medium&quot;&gt;C&oacute;digos de Infracci&oacute;n / Delitos&lt;/label&gt;&lt;div id=&quot;infracciones-container&quot; class=&quot;space-y-2&quot;&gt;&lt;div class=&quot;flex items-center space-x-2&quot;&gt;&lt;input type=&quot;text&quot; name=&quot;articulo&quot; class=&quot;bg-gray-50 dark:bg-gray-700 border text-sm rounded-lg block w-full p-2.5&quot; required&gt;&lt;/div&gt;&lt;/div&gt;&lt;button type=&quot;button&quot; id=&quot;add-infraccion-btn&quot; class=&quot;mt-2 text-sm text-green-700 hover:text-green-900 font-medium&quot;&gt;&lt;i class=&quot;fas fa-plus-circle mr-1&quot;&gt;&lt;/i&gt; Agregar otra infracci&oacute;n&lt;/button&gt;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;mt-6&quot;&gt;&lt;label for=&quot;descripcion&quot; class=&quot;block mb-2 text-sm font-medium&quot;&gt;Detalles del Procedimiento&lt;/label&gt;&lt;textarea id=&quot;descripcion&quot; rows=&quot;4&quot; class=&quot;block p-2.5 w-full text-sm bg-gray-50 dark:bg-gray-700 rounded-lg border&quot;&gt;&lt;/textarea&gt;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/fieldset&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;fieldset class=&quot;border border-gray-300 dark:border-gray-600 p-4 rounded-lg&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;legend class=&quot;px-2 font-semibold text-lg text-green-700 dark:text-green-500&quot;&gt;3. Datos Adicionales (Opcional)&lt;/legend&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;space-y-6&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div&gt;&lt;div class=&quot;flex items-center&quot;&gt;&lt;input id=&quot;hubo-detenidos&quot; type=&quot;checkbox&quot; class=&quot;w-4 h-4 text-green-600 bg-gray-100 rounded focus:ring-green-500&quot;&gt;&lt;label for=&quot;hubo-detenidos&quot; class=&quot;ml-2 text-sm font-medium&quot;&gt;&iquest;Hay personas detenidas?&lt;/label&gt;&lt;/div&gt;&lt;div id=&quot;detalles-detenidos&quot; class=&quot;hidden mt-2 space-y-4&quot;&gt;&lt;div id=&quot;detenidos-container&quot; class=&quot;space-y-3&quot;&gt;&lt;/div&gt;&lt;button type=&quot;button&quot; id=&quot;add-detenido-btn&quot; class=&quot;text-sm text-green-700 hover:text-green-900 font-medium&quot;&gt;&lt;i class=&quot;fas fa-user-plus mr-1&quot;&gt;&lt;/i&gt; Agregar otro detenido&lt;/button&gt;&lt;/div&gt;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;border-t pt-4&quot;&gt;&lt;div class=&quot;flex items-center&quot;&gt;&lt;input id=&quot;hubo-vehiculos-secuestrados&quot; type=&quot;checkbox&quot; class=&quot;w-4 h-4 text-green-600 bg-gray-100 rounded focus:ring-green-500&quot;&gt;&lt;label for=&quot;hubo-vehiculos-secuestrados&quot; class=&quot;ml-2 text-sm font-medium&quot;&gt;&iquest;Se secuestraron veh&iacute;culos?&lt;/label&gt;&lt;/div&gt;&lt;div id=&quot;detalles-vehiculos-secuestrados&quot; class=&quot;hidden mt-2 space-y-4&quot;&gt;&lt;div id=&quot;vehiculos-container&quot; class=&quot;space-y-3&quot;&gt;&lt;/div&gt;&lt;button type=&quot;button&quot; id=&quot;add-vehiculo-btn&quot; class=&quot;text-sm text-green-700 hover:text-green-900 font-medium&quot;&gt;&lt;i class=&quot;fas fa-car mr-1&quot;&gt;&lt;/i&gt; Agregar otro veh&iacute;culo&lt;/button&gt;&lt;/div&gt;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;border-t pt-4&quot;&gt;&lt;div class=&quot;flex items-center&quot;&gt;&lt;input id=&quot;hubo-secuestro&quot; type=&quot;checkbox&quot; class=&quot;w-4 h-4 text-green-600 bg-gray-100 rounded focus:ring-green-500&quot;&gt;&lt;label for=&quot;hubo-secuestro&quot; class=&quot;ml-2 text-sm font-medium&quot;&gt;&iquest;Hubo secuestro de otros elementos?&lt;/label&gt;&lt;/div&gt;&lt;div id=&quot;detalles-secuestro&quot; class=&quot;hidden mt-2 space-y-6&quot;&gt;&lt;/div&gt;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/fieldset&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;fieldset class=&quot;border border-gray-300 dark:border-gray-600 p-4 rounded-lg&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;legend class=&quot;px-2 font-semibold text-lg text-green-700 dark:text-green-500&quot;&gt;4. Evidencia Multimedia&lt;/legend&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;label for=&quot;file-upload&quot; class=&quot;mt-2 inline-block cursor-pointer bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 font-bold py-2 px-4 rounded-lg&quot;&gt;&lt;i class=&quot;fas fa-camera mr-2&quot;&gt;&lt;/i&gt; Seleccionar Fotos/Videos...&lt;/label&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;input id=&quot;file-upload&quot; type=&quot;file&quot; class=&quot;hidden&quot; multiple accept=&quot;image/*,video/*&quot;&gt;&lt;div id=&quot;file-preview-container&quot; class=&quot;mt-4 space-y-2&quot;&gt;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/fieldset&gt;<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;mt-6 text-right&quot;&gt;&lt;button type=&quot;submit&quot; class=&quot;text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:outline-none focus:ring-green-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800&quot;&gt;&lt;i class=&quot;fas fa-save mr-2&quot;&gt;&lt;/i&gt; Guardar Procedimiento&lt;/button&gt;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/form&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;h2 class=&quot;text-2xl font-semibold mb-4 border-b border-gray-300 dark:border-gray-600 pb-2&quot;&gt;&lt;i class=&quot;fas fa-list-alt mr-2 text-green-700&quot;&gt;&lt;/i&gt; Procedimientos Recientes&lt;/h2&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=&quot;infracciones-list&quot; class=&quot;space-y-3&quot;&gt;&lt;p id=&quot;loading-message&quot; class=&quot;text-center text-gray-500 dark:text-gray-400 p-4&quot;&gt;Cargando...&lt;/p&gt;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/main&gt;<br> &nbsp; &nbsp;&lt;/div&gt;<br><br> &nbsp; &nbsp;&lt;div id=&quot;modal-view&quot; class=&quot;fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 z-50 hidden&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;bg-white dark:bg-gray-800 rounded-lg shadow-2xl max-w-2xl w-full max-h-full overflow-y-auto&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=&quot;printable-area&quot; class=&quot;p-8&quot;&gt;&lt;div id=&quot;modal-content&quot;&gt;&lt;/div&gt;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;div class=&quot;px-8 py-4 bg-gray-100 dark:bg-gray-700 border-t border-gray-200 dark:border-gray-600 flex justify-end space-x-4 no-print&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button onclick=&quot;window.print()&quot; class=&quot;px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700&quot;&gt;&lt;i class=&quot;fas fa-print mr-2&quot;&gt;&lt;/i&gt;Imprimir / Guardar PDF&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;close-modal&quot; class=&quot;px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600&quot;&gt;Cerrar&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp;&lt;/div&gt;<br><br> &nbsp; &nbsp;&lt;script type=&quot;module&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;import { initializeApp } from &quot;https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js&quot;;<br> &nbsp; &nbsp; &nbsp; &nbsp;import { getAuth, signInAnonymously, onAuthStateChanged } from &quot;https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js&quot;;<br> &nbsp; &nbsp; &nbsp; &nbsp;import { getFirestore, collection, addDoc, onSnapshot, query, doc, getDoc, serverTimestamp } from &quot;https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js&quot;;<br> &nbsp; &nbsp; &nbsp; &nbsp;import { setLogLevel } from &quot;https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js&quot;;<br><br> &nbsp; &nbsp; &nbsp; &nbsp;const firebaseConfig = JSON.parse(typeof __firebase_config !== &#39;undefined&#39; ? __firebase_config : &#39;{}&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;const appId = typeof __app_id !== &#39;undefined&#39; ? __app_id : &#39;default-app-id-infracciones&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp;const app = initializeApp(firebaseConfig);<br> &nbsp; &nbsp; &nbsp; &nbsp;const db = getFirestore(app);<br> &nbsp; &nbsp; &nbsp; &nbsp;const auth = getAuth(app);<br> &nbsp; &nbsp; &nbsp; &nbsp;setLogLevel(&#39;debug&#39;);<br><br> &nbsp; &nbsp; &nbsp; &nbsp;const appView = document.getElementById(&#39;app-view&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;const userIdDisplay = document.getElementById(&#39;user-id-display&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;const infraccionForm = document.getElementById(&#39;infraccion-form&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;const infraccionesList = document.getElementById(&#39;infracciones-list&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;const loadingMessage = document.getElementById(&#39;loading-message&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;const modalView = document.getElementById(&#39;modal-view&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;const modalContent = document.getElementById(&#39;modal-content&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;const closeModalButton = document.getElementById(&#39;close-modal&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;const addInfraccionBtn = document.getElementById(&#39;add-infraccion-btn&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;const infraccionesContainer = document.getElementById(&#39;infracciones-container&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;const huboDetenidosCheckbox = document.getElementById(&#39;hubo-detenidos&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;const detallesDetenidosDiv = document.getElementById(&#39;detalles-detenidos&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;const detenidosContainer = document.getElementById(&#39;detenidos-container&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;const addDetenidoBtn = document.getElementById(&#39;add-detenido-btn&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;const huboVehiculosCheckbox = document.getElementById(&#39;hubo-vehiculos-secuestrados&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;const detallesVehiculosDiv = document.getElementById(&#39;detalles-vehiculos-secuestrados&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;const vehiculosContainer = document.getElementById(&#39;vehiculos-container&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;const addVehiculoBtn = document.getElementById(&#39;add-vehiculo-btn&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;const huboSecuestroCheckbox = document.getElementById(&#39;hubo-secuestro&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;const detallesSecuestroDiv = document.getElementById(&#39;detalles-secuestro&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;const fileUploadInput = document.getElementById(&#39;file-upload&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;const filePreviewContainer = document.getElementById(&#39;file-preview-container&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;const getLocationBtn = document.getElementById(&#39;get-location-btn&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;const latitudInput = document.getElementById(&#39;latitud&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;const longitudInput = document.getElementById(&#39;longitud&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;const mapContainer = document.getElementById(&#39;map-container&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;const locationStatus = document.getElementById(&#39;location-status&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;let map = null;<br> &nbsp; &nbsp; &nbsp; &nbsp;let marker = null;<br> &nbsp; &nbsp; &nbsp; &nbsp;let currentUserId = null;<br> &nbsp; &nbsp; &nbsp; &nbsp;let unsubscribeInfracciones = null;<br> &nbsp; &nbsp; &nbsp; &nbsp;let selectedFiles = [];<br><br> &nbsp; &nbsp; &nbsp; &nbsp;// --- L&Oacute;GICA DE GEOLOCALIZACI&Oacute;N ---<br> &nbsp; &nbsp; &nbsp; &nbsp;getLocationBtn.addEventListener(&#39;click&#39;, () =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (!navigator.geolocation) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;locationStatus.textContent = &#39;Geolocalizaci&oacute;n no es soportada por su navegador.&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;locationStatus.textContent = &#39;Obteniendo ubicaci&oacute;n...&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;locationStatus.classList.remove(&#39;text-red-500&#39;);<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;navigator.geolocation.getCurrentPosition(<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(position) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const { latitude, longitude } = position.coords;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;latitudInput.value = latitude.toFixed(6);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;longitudInput.value = longitude.toFixed(6);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;locationStatus.textContent = &#39;Ubicaci&oacute;n obtenida con &eacute;xito.&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mapContainer.classList.remove(&#39;hidden&#39;);<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (!map) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;map = L.map(&#39;map&#39;).setView([latitude, longitude], 16);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;L.tileLayer(&#39;https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png&#39;, { attribution: &#39;&copy; OpenStreetMap contributors&#39; }).addTo(map);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;marker = L.marker([latitude, longitude]).addTo(map);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;map.setView([latitude, longitude], 16);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;marker.setLatLng([latitude, longitude]);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;map.bindPopup(&#39;Ubicaci&oacute;n del procedimiento.&#39;).openPopup();<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// CORRECCI&Oacute;N: Forzar la actualizaci&oacute;n del tama&ntilde;o del mapa despu&eacute;s de que sea visible.<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;setTimeout(() =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (map) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; map.invalidateSize();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}, 100);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;() =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;locationStatus.textContent = &#39;No se pudo obtener la ubicaci&oacute;n. Verifique los permisos.&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;locationStatus.classList.add(&#39;text-red-500&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;);<br> &nbsp; &nbsp; &nbsp; &nbsp;});<br><br> &nbsp; &nbsp; &nbsp; &nbsp;// --- RESTO DE L&Oacute;GICA DE UI ---<br> &nbsp; &nbsp; &nbsp; &nbsp;huboDetenidosCheckbox.addEventListener(&#39;change&#39;, () =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;detallesDetenidosDiv.classList.toggle(&#39;hidden&#39;, !huboDetenidosCheckbox.checked);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (huboDetenidosCheckbox.checked &amp;&amp; detenidosContainer.children.length === 0) addDetenido();<br> &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;huboVehiculosCheckbox.addEventListener(&#39;change&#39;, () =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;detallesVehiculosDiv.classList.toggle(&#39;hidden&#39;, !huboVehiculosCheckbox.checked);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (huboVehiculosCheckbox.checked &amp;&amp; vehiculosContainer.children.length === 0) addVehiculo();<br> &nbsp; &nbsp; &nbsp; &nbsp;});<br><br> &nbsp; &nbsp; &nbsp; &nbsp;huboSecuestroCheckbox.addEventListener(&#39;change&#39;, () =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (!detallesSecuestroDiv.innerHTML.trim()) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;detallesSecuestroDiv.innerHTML = `&lt;div class=&quot;grid md:grid-cols-2 gap-6&quot;&gt;&lt;div&gt;&lt;label class=&quot;block mb-2 text-sm&quot;&gt;Tipo&lt;/label&gt;&lt;select id=&quot;tipo-secuestro&quot; class=&quot;bg-gray-50 dark:bg-gray-700 border text-sm rounded-lg block w-full p-2.5&quot;&gt;&lt;option&gt;Estupefacientes&lt;/option&gt;&lt;option&gt;Cigarrillos&lt;/option&gt;&lt;option&gt;Otro&lt;/option&gt;&lt;/select&gt;&lt;/div&gt;&lt;div&gt;&lt;label class=&quot;block mb-2 text-sm&quot;&gt;Causa/Magistrado&lt;/label&gt;&lt;input type=&quot;text&quot; id=&quot;causa-judicial&quot; class=&quot;bg-gray-50 dark:bg-gray-700 border text-sm rounded-lg block w-full p-2.5&quot;&gt;&lt;/div&gt;&lt;div class=&quot;md:col-span-2&quot;&gt;&lt;label class=&quot;block mb-2 text-sm&quot;&gt;Descripci&oacute;n&lt;/label&gt;&lt;textarea id=&quot;descripcion-secuestro&quot; rows=&quot;3&quot; class=&quot;block p-2.5 w-full text-sm bg-gray-50 dark:bg-gray-700 rounded-lg border&quot;&gt;&lt;/textarea&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;border-t pt-6 mt-6&quot;&gt;&lt;h4 class=&quot;text-md font-semibold mb-4&quot;&gt;Aval&uacute;o&lt;/h4&gt;&lt;div class=&quot;grid md:grid-cols-3 gap-4 items-end&quot;&gt;&lt;div&gt;&lt;label class=&quot;block mb-2 text-sm&quot;&gt;Cantidad&lt;/label&gt;&lt;input type=&quot;number&quot; id=&quot;secuestro-cantidad&quot; step=&quot;any&quot; class=&quot;bg-gray-50 dark:bg-gray-700 border text-sm rounded-lg w-full p-2.5&quot;&gt;&lt;/div&gt;&lt;div&gt;&lt;label class=&quot;block mb-2 text-sm&quot;&gt;Unidad&lt;/label&gt;&lt;input type=&quot;text&quot; id=&quot;secuestro-unidad&quot; class=&quot;bg-gray-50 dark:bg-gray-700 border text-sm rounded-lg w-full p-2.5&quot;&gt;&lt;/div&gt;&lt;div&gt;&lt;label class=&quot;block mb-2 text-sm&quot;&gt;Valor Unitario ($)&lt;/label&gt;&lt;input type=&quot;number&quot; id=&quot;secuestro-valor-unitario&quot; step=&quot;any&quot; class=&quot;bg-gray-50 dark:bg-gray-700 border text-sm rounded-lg w-full p-2.5&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;mt-4 bg-gray-100 dark:bg-gray-800 p-4 rounded-lg text-center&quot;&gt;&lt;p class=&quot;text-sm font-medium&quot;&gt;TOTAL&lt;/p&gt;&lt;p id=&quot;avaluo-total&quot; class=&quot;text-2xl font-bold text-green-600&quot;&gt;$ 0,00&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;`;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&#39;secuestro-cantidad&#39;).addEventListener(&#39;input&#39;, calcularAvaluo);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&#39;secuestro-valor-unitario&#39;).addEventListener(&#39;input&#39;, calcularAvaluo);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;detallesSecuestroDiv.classList.toggle(&#39;hidden&#39;, !huboSecuestroCheckbox.checked);<br> &nbsp; &nbsp; &nbsp; &nbsp;});<br><br> &nbsp; &nbsp; &nbsp; &nbsp;function calcularAvaluo() {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const cant = parseFloat(document.getElementById(&#39;secuestro-cantidad&#39;)?.value) || 0;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const val = parseFloat(document.getElementById(&#39;secuestro-valor-unitario&#39;)?.value) || 0;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const total = cant * val;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const display = document.getElementById(&#39;avaluo-total&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (display) display.textContent = total.toLocaleString(&#39;es-AR&#39;, { style: &#39;currency&#39;, currency: &#39;ARS&#39; });<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br><br> &nbsp; &nbsp; &nbsp; &nbsp;const createDynamicField = (html) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const div = document.createElement(&#39;div&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;div.innerHTML = html;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return div.firstElementChild;<br> &nbsp; &nbsp; &nbsp; &nbsp;};<br><br> &nbsp; &nbsp; &nbsp; &nbsp;addInfraccionBtn.addEventListener(&#39;click&#39;, () =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const newField = createDynamicField(`&lt;div class=&quot;flex items-center space-x-2&quot;&gt;&lt;input type=&quot;text&quot; name=&quot;articulo&quot; class=&quot;bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-sm rounded-lg block w-full p-2.5&quot; placeholder=&quot;Siguiente infracci&oacute;n...&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;remove-btn text-red-500 hover:text-red-700 p-2&quot;&gt;&lt;i class=&quot;fas fa-minus-circle&quot;&gt;&lt;/i&gt;&lt;/button&gt;&lt;/div&gt;`);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;infraccionesContainer.appendChild(newField);<br> &nbsp; &nbsp; &nbsp; &nbsp;});<br><br> &nbsp; &nbsp; &nbsp; &nbsp;const addDetenido = () =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const newField = createDynamicField(`&lt;div class=&quot;grid grid-cols-1 md:grid-cols-3 gap-2 items-center border-t pt-3&quot;&gt;&lt;input type=&quot;text&quot; name=&quot;detenido_dni&quot; class=&quot;bg-gray-50 dark:bg-gray-700 border text-sm rounded-lg block w-full p-2.5&quot; placeholder=&quot;DNI del detenido&quot; required&gt;&lt;input type=&quot;text&quot; name=&quot;detenido_nombre&quot; class=&quot;bg-gray-50 dark:bg-gray-700 border text-sm rounded-lg block w-full p-2.5 md:col-span-2&quot; placeholder=&quot;Nombre y Apellido&quot; required&gt;&lt;div class=&quot;text-right md:col-start-3&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;remove-btn text-red-500 hover:text-red-700 p-2&quot;&gt;&lt;i class=&quot;fas fa-trash&quot;&gt;&lt;/i&gt;&lt;/button&gt;&lt;/div&gt;&lt;/div&gt;`);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;detenidosContainer.appendChild(newField);<br> &nbsp; &nbsp; &nbsp; &nbsp;};<br> &nbsp; &nbsp; &nbsp; &nbsp;addDetenidoBtn.addEventListener(&#39;click&#39;, addDetenido);<br><br> &nbsp; &nbsp; &nbsp; &nbsp;const addVehiculo = () =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const newField = createDynamicField(`&lt;div class=&quot;space-y-2 border-t pt-3&quot;&gt;&lt;div class=&quot;grid grid-cols-2 gap-2&quot;&gt;&lt;input type=&quot;text&quot; name=&quot;vehiculo_marca_modelo&quot; class=&quot;bg-gray-50 dark:bg-gray-700 border text-sm rounded-lg w-full p-2.5 col-span-2&quot; placeholder=&quot;Marca y Modelo&quot; required&gt;&lt;input type=&quot;text&quot; name=&quot;vehiculo_dominio&quot; class=&quot;bg-gray-50 dark:bg-gray-700 border text-sm rounded-lg w-full p-2.5&quot; placeholder=&quot;Dominio&quot; required&gt;&lt;input type=&quot;text&quot; name=&quot;vehiculo_motivo&quot; class=&quot;bg-gray-50 dark:bg-gray-700 border text-sm rounded-lg w-full p-2.5&quot; placeholder=&quot;Motivo del secuestro&quot;&gt;&lt;input type=&quot;text&quot; name=&quot;vehiculo_chasis&quot; class=&quot;bg-gray-50 dark:bg-gray-700 border text-sm rounded-lg w-full p-2.5&quot; placeholder=&quot;N&deg; Chasis&quot;&gt;&lt;input type=&quot;text&quot; name=&quot;vehiculo_motor&quot; class=&quot;bg-gray-50 dark:bg-gray-700 border text-sm rounded-lg w-full p-2.5&quot; placeholder=&quot;N&deg; Motor&quot;&gt;&lt;/div&gt;&lt;div class=&quot;text-right&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;remove-btn text-red-500 hover:text-red-700 p-2&quot;&gt;&lt;i class=&quot;fas fa-trash&quot;&gt;&lt;/i&gt;&lt;/button&gt;&lt;/div&gt;&lt;/div&gt;`);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;vehiculosContainer.appendChild(newField);<br> &nbsp; &nbsp; &nbsp; &nbsp;};<br> &nbsp; &nbsp; &nbsp; &nbsp;addVehiculoBtn.addEventListener(&#39;click&#39;, addVehiculo);<br> &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;infraccionForm.addEventListener(&#39;click&#39;, (e) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (e.target.closest(&#39;.remove-btn&#39;)) e.target.closest(&#39;.flex, .grid, .space-y-2&#39;).remove();<br> &nbsp; &nbsp; &nbsp; &nbsp;});<br><br> &nbsp; &nbsp; &nbsp; &nbsp;fileUploadInput.addEventListener(&#39;change&#39;, (e) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;selectedFiles = Array.from(e.target.files);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;filePreviewContainer.innerHTML = &#39;&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;selectedFiles.forEach(file =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const iconClass = file.type.startsWith(&#39;image/&#39;) ? &#39;fa-file-image&#39; : &#39;fa-file-video&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;filePreviewContainer.innerHTML += `&lt;div class=&quot;flex items-center justify-between bg-gray-100 dark:bg-gray-700 p-2 rounded-lg&quot;&gt;&lt;div class=&quot;flex items-center space-x-2&quot;&gt;&lt;i class=&quot;fas ${iconClass} text-green-500&quot;&gt;&lt;/i&gt;&lt;span class=&quot;text-sm&quot;&gt;${file.name}&lt;/span&gt;&lt;/div&gt;&lt;span class=&quot;text-xs text-gray-500&quot;&gt;${(file.size / 1024).toFixed(1)} KB&lt;/span&gt;&lt;/div&gt;`;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp; &nbsp; &nbsp;});<br><br> &nbsp; &nbsp; &nbsp; &nbsp;onAuthStateChanged(auth, user =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (user) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;currentUserId = user.uid;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;userIdDisplay.textContent = currentUserId;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&#39;login-view&#39;).classList.remove(&#39;hidden&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;appView.classList.remove(&#39;hidden&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;setupInfraccionesListener();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;signInAnonymously(auth).catch(error =&gt; console.error(&quot;Login an&oacute;nimo fall&oacute;:&quot;, error));<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;});<br><br> &nbsp; &nbsp; &nbsp; &nbsp;function setupInfraccionesListener() {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (unsubscribeInfracciones) return;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const q = query(collection(db, `artifacts/${appId}/public/data/procedimientos`));<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;unsubscribeInfracciones = onSnapshot(q, (snapshot) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;infraccionesList.innerHTML = &#39;&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (snapshot.empty) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;loadingMessage.textContent = &#39;No hay procedimientos cargados.&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;infraccionesList.appendChild(loadingMessage);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const sortedDocs = snapshot.docs.sort((a, b) =&gt; (b.data().timestamp?.toMillis() || 0) - (a.data().timestamp?.toMillis() || 0));<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sortedDocs.forEach(doc =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const proc = doc.data();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const procEl = document.createElement(&#39;div&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;procEl.className = &#39;flex items-center justify-between bg-gray-50 dark:bg-gray-700 p-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-600&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;procEl.innerHTML = `&lt;div&gt;&lt;p class=&quot;font-bold text-md text-green-800 dark:text-green-500&quot;&gt;${proc.caratula || `Dominio: ${proc.dominio}`}&lt;/p&gt;&lt;p class=&quot;text-sm text-gray-600 dark:text-gray-400&quot;&gt;&lt;i class=&quot;fas fa-calendar-alt mr-1&quot;&gt;&lt;/i&gt; ${new Date(proc.fechaHora).toLocaleString(&#39;es-AR&#39;)}${proc.huboSecuestro ? &#39; &lt;i class=&quot;fas fa-box-open ml-3 text-red-500&quot; title=&quot;Secuestro de elementos&quot;&gt;&lt;/i&gt;&#39; : &#39;&#39;}${proc.huboDetenidos ? &#39; &lt;i class=&quot;fas fa-user-lock ml-2 text-blue-500&quot; title=&quot;Detenidos&quot;&gt;&lt;/i&gt;&#39; : &#39;&#39;}${proc.huboVehiculosSecuestrados ? &#39; &lt;i class=&quot;fas fa-car-side ml-2 text-orange-500&quot; title=&quot;Veh&iacute;culos secuestrados&quot;&gt;&lt;/i&gt;&#39; : &#39;&#39;}&lt;/p&gt;&lt;/div&gt;&lt;button data-id=&quot;${doc.id}&quot; class=&quot;view-details-btn px-3 py-2 text-sm text-white bg-green-700 rounded-lg hover:bg-green-800&quot;&gt;Ver Acta&lt;/button&gt;`;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;infraccionesList.appendChild(procEl);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br><br> &nbsp; &nbsp; &nbsp; &nbsp;infraccionForm.addEventListener(&#39;submit&#39;, async (e) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;e.preventDefault();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const articulos = Array.from(document.querySelectorAll(&#39;input[name=&quot;articulo&quot;]&#39;)).map(i =&gt; i.value.trim()).filter(v =&gt; v);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const detenidos = Array.from(document.querySelectorAll(&#39;#detenidos-container &gt; div&#39;)).map(div =&gt; ({ dni: div.querySelector(&#39;input[name=&quot;detenido_dni&quot;]&#39;).value, nombre: div.querySelector(&#39;input[name=&quot;detenido_nombre&quot;]&#39;).value, })).filter(d =&gt; d.dni &amp;&amp; d.nombre);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const vehiculosSecuestrados = Array.from(document.querySelectorAll(&#39;#vehiculos-container &gt; div&#39;)).map(div =&gt; ({ marcaModelo: div.querySelector(&#39;input[name=&quot;vehiculo_marca_modelo&quot;]&#39;).value, dominio: div.querySelector(&#39;input[name=&quot;vehiculo_dominio&quot;]&#39;).value, motivo: div.querySelector(&#39;input[name=&quot;vehiculo_motivo&quot;]&#39;).value, chasis: div.querySelector(&#39;input[name=&quot;vehiculo_chasis&quot;]&#39;).value, motor: div.querySelector(&#39;input[name=&quot;vehiculo_motor&quot;]&#39;).value, })).filter(v =&gt; v.marcaModelo);<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;let procedimientoData = {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;caratula: document.getElementById(&#39;caratula&#39;).value,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;agenteDNI: document.getElementById(&#39;agente-dni&#39;).value,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;agenteCodigo: document.getElementById(&#39;agente-codigo&#39;).value,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;patrulla: document.getElementById(&#39;patrulla&#39;).value,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dni: document.getElementById(&#39;dni&#39;).value,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dominio: document.getElementById(&#39;dominio&#39;).value.toUpperCase(),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;fechaHora: document.getElementById(&#39;fecha-hora&#39;).value,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;lugar: document.getElementById(&#39;lugar&#39;).value,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;latitud: document.getElementById(&#39;latitud&#39;).value,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;longitud: document.getElementById(&#39;longitud&#39;).value,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;articulos,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;descripcion: document.getElementById(&#39;descripcion&#39;).value,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cargadoPorId: currentUserId,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;timestamp: serverTimestamp(),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;huboDetenidos: huboDetenidosCheckbox.checked &amp;&amp; detenidos.length &gt; 0,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;detenidos,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;huboVehiculosSecuestrados: huboVehiculosCheckbox.checked &amp;&amp; vehiculosSecuestrados.length &gt; 0,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;vehiculosSecuestrados,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;huboSecuestro: huboSecuestroCheckbox.checked,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;archivosMultimedia: selectedFiles.map(f =&gt; f.name)<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;};<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (procedimientoData.huboSecuestro) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// ...<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await addDoc(collection(db, `artifacts/${appId}/public/data/procedimientos`), procedimientoData);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;infraccionForm.reset();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Limpiar todo despu&eacute;s de guardar<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;detallesSecuestroDiv.classList.add(&#39;hidden&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;detallesSecuestroDiv.innerHTML = &#39;&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;detallesDetenidosDiv.classList.add(&#39;hidden&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;detenidosContainer.innerHTML = &#39;&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;detallesVehiculosDiv.classList.add(&#39;hidden&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;vehiculosContainer.innerHTML = &#39;&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;infraccionesContainer.innerHTML = &#39;&lt;div class=&quot;flex items-center space-x-2&quot;&gt;&lt;input type=&quot;text&quot; name=&quot;articulo&quot; class=&quot;bg-gray-50 dark:bg-gray-700 border text-sm rounded-lg block w-full p-2.5&quot; required&gt;&lt;/div&gt;&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;filePreviewContainer.innerHTML = &#39;&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mapContainer.classList.add(&#39;hidden&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if(map) { map.remove(); map = null; marker = null; }<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;selectedFiles = [];<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} catch (error) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.error(&quot;Error al guardar:&quot;, error);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;infraccionesList.addEventListener(&#39;click&#39;, async (e) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (e.target.closest(&#39;.view-details-btn&#39;)) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const docId = e.target.closest(&#39;.view-details-btn&#39;).dataset.id;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const docRef = doc(db, `artifacts/${appId}/public/data/procedimientos`, docId);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const docSnap = await getDoc(docRef);<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (docSnap.exists()) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const data = docSnap.data();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// ... L&oacute;gica del modal completa para mostrar los datos<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;modalContent.innerHTML = `<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;h2 class=&quot;text-xl font-bold text-center mb-2&quot;&gt;ACTA DE PROCEDIMIENTO&lt;/h2&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;p class=&quot;text-center text-lg mb-4 text-gray-700 dark:text-gray-300 font-semibold&quot;&gt;${data.caratula || &#39;Sin Car&aacute;tula&#39;}&lt;/p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;!-- El resto del contenido del acta se genera aqu&iacute; din&aacute;micamente --&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;`;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;modalView.classList.remove(&#39;hidden&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;closeModalButton.addEventListener(&#39;click&#39;, () =&gt; modalView.classList.add(&#39;hidden&#39;));<br> &nbsp; &nbsp; &nbsp; &nbsp;modalView.addEventListener(&#39;click&#39;, (e) =&gt; { if (e.target === modalView) modalView.classList.add(&#39;hidden&#39;); });<br> &nbsp; &nbsp;&lt;/script&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br></span></p></body></html>